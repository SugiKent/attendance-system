# コンプライアンスレポート機能

## 概要

コンプライアンスレポート機能は、企業の労務管理における法令遵守状況を可視化し、潜在的なリスクを早期に発見するための機能です。このレポートは、残業時間、休憩取得状況、休日労働、深夜労働、有給休暇取得状況などの重要な労務指標を監視し、法令違反のリスクがある従業員を特定します。

## 主な機能

### 1. 残業時間監視

- **月間残業時間の集計**: 従業員ごとの月間残業時間を集計
- **法定上限（月45時間）超過者の検出**: 労働基準法で定められた残業時間の上限を超える従業員を特定
- **残業時間の多い従業員ランキング**: 残業時間の多い順に従業員をリスト化

### 2. 休憩取得状況

- **休憩時間不足の検出**: 8時間超の勤務で法定休憩時間（60分）を取得していない勤務日を特定
- **休憩取得率の計算**: 適切な休憩を取得している日数の割合を計算
- **休憩不足の従業員リスト**: 休憩取得率の低い従業員を特定

### 3. 休日労働監視

- **休日労働日数の集計**: 土日・祝日の勤務日数を集計
- **休日労働時間の集計**: 休日に働いた時間の合計を計算
- **休日出勤の多い従業員リスト**: 休日出勤が多い従業員を特定

### 4. 深夜労働監視

- **深夜労働（22時〜5時）の検出**: 深夜時間帯の勤務を検出
- **深夜労働時間の集計**: 深夜時間帯に働いた時間の合計を計算
- **深夜勤務の多い従業員リスト**: 深夜勤務が多い従業員を特定

### 5. 有給休暇取得状況

- **有給休暇取得日数の集計**: 従業員ごとの有給休暇取得日数を集計
- **年5日取得義務の達成状況**: 年次有給休暇の5日取得義務を達成している従業員の割合を計算
- **有給休暇取得率の低い従業員リスト**: 有給休暇の取得が少ない従業員を特定

## 画面説明

### 会社コンプライアンスレポート画面

会社全体の労務コンプライアンス状況を一覧で表示します。

![会社コンプライアンスレポート画面](../frontend/public/images/company-compliance-report.png)

#### 表示項目

1. **期間選択**: 年月を選択してレポートを表示
2. **会社サマリー**: 総ユーザー数、アクティブユーザー数
3. **残業時間状況**: 総残業時間、平均残業時間、月45時間超過者数
4. **休憩取得状況**: 総勤務日数、休憩不足日数、休憩取得率
5. **休日労働状況**: 休日労働日数、休日労働時間、休日出勤者数
6. **深夜労働状況**: 深夜労働日数、深夜労働時間、深夜勤務者数
7. **有給休暇取得状況**: 総有給休暇取得日数、平均取得日数、年5日取得達成率
8. **コンプライアンス注意事項**: 検出された法令違反リスクの一覧

### 部門別コンプライアンスレポート画面

部門ごとの労務コンプライアンス状況を比較表示します。

#### 表示項目

1. **期間選択**: 年月を選択してレポートを表示
2. **部門選択**: 特定の部門を選択して詳細表示
3. **部門別サマリー**: 部門ごとの主要指標を一覧表示
   - 残業時間
   - 休日労働日数
   - 深夜労働日数
   - 有給休暇取得日数
4. **部門内ユーザー一覧**: 選択した部門の従業員ごとの詳細データ

### ユーザー別コンプライアンスレポート画面

特定のユーザーの労務コンプライアンス状況を詳細表示します。

#### 表示項目

1. **期間選択**: 年月を選択してレポートを表示
2. **ユーザー情報**: 名前、部門、役職など
3. **コンプライアンスステータス**: 各指標の詳細データ
4. **コンプライアンス違反リスト**: 日付ごとの法令違反リスクを一覧表示

## 利用方法

### 管理者向け

1. 管理者ダッシュボードにログイン
2. 「レポート」メニューから「コンプライアンスレポート」を選択
3. 表示したい年月を選択
4. 会社全体、部門別、またはユーザー別のレポートを選択して表示
5. 必要に応じてCSVエクスポート機能を使用してデータをダウンロード

### 注意事項

- コンプライアンスレポートは管理者権限を持つユーザーのみが閲覧可能です
- レポートデータは日次で更新されます（前日までのデータが反映されます）
- 法令違反の可能性がある項目は自動的にハイライト表示されます

## API仕様

コンプライアンスレポートAPIの詳細仕様については、[API仕様書](./api-spec.md#コンプライアンスレポートapi)を参照してください。

## 技術的実装

コンプライアンスレポート機能は以下のコンポーネントで構成されています：

1. **バックエンド**:
   - `reportController.ts`: レポートデータの集計と提供を行うコントローラー
   - `reportRoutes.ts`: レポート関連のAPIエンドポイントを定義

2. **フロントエンド**:
   - `CompanyComplianceReport.tsx`: 会社全体のコンプライアンスレポートを表示するコンポーネント
   - `DepartmentReport.tsx`: 部門別レポートを表示するコンポーネント
   - `UserReport.tsx`: ユーザー別レポートを表示するコンポーネント
   - `reportStore.ts`: レポートデータの状態管理を行うストア

## 今後の拡張予定

1. **アラート機能**: 法令違反リスクが検出された場合に管理者に自動通知する機能
2. **改善提案機能**: 検出された問題に対する改善策を提案する機能
3. **トレンド分析**: 過去のデータと比較して傾向を分析する機能
4. **予測分析**: 現在のデータから将来のリスクを予測する機能
5. **カスタムレポート**: 管理者が必要な指標を選択してカスタムレポートを作成できる機能
